LOGIN admin pass
CREATE ROLE ROLECUSTOMER CK
CREATE ROLE ROLEMANAGER MK
CREATE USER USER1 PASS1
CREATE USER USER2 PASS2
GRANT ROLE USER1 ROLEMANAGER
GRANT ROLE USER2 ROLECUSTOMER
GRANT PRIVILEGE INSERT TO ROLEMANAGER ON Customers
GRANT PRIVILEGE INSERT TO ROLEMANAGER ON Products
GRANT PRIVILEGE SELECT TO ROLEMANAGER ON Customers
GRANT PRIVILEGE SELECT TO ROLEMANAGER ON Products
GRANT PRIVILEGE SELECT TO ROLECUSTOMER ON Products
LOGIN USER1 PASS1
INSERT INTO Customers VALUES ('1', 'first 1', 'last 1', 'address 1') ENCRYPT 4 ROLEMANAGER
INSERT INTO Products VALUES ('1', 'product 1', 'category 1', '1', '19.99') ENCRYPT 3 ROLECUSTOMER
SELECT * FROM Customers
SELECT * FROM Products
LOGIN USER2 PASS2
SELECT * FROM Customers
SELECT * FROM Products
INSERT INTO Customers VALUES ('2', 'first 2', 'last 2', 'address 2') ENCRYPT 3 ROLEMANAGER
LOGIN admin pass
REVOKE PRIVILEGE SELECT FROM ROLECUSTOMER ON Products
LOGIN USER2 PASS2
SELECT * FROM Products
QUIT
