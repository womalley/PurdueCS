LOGIN admin pass
CREATE ROLE R1 ONE
CREATE ROLE R2 TWO
CREATE ROLE R3 THREE
CREATE USER U1 P1
CREATE USER U2 P2
CREATE USER U3 P3
CREATE USER U4 P4
CREATE USER U5 P5
GRANT ROLE U1 R1
GRANT ROLE U2 R1
GRANT ROLE U3 R1
GRANT ROLE U2 R2
GRANT ROLE U3 R2
GRANT ROLE U2 R3
GRANT ROLE U4 R3
GRANT PRIVILEGE INSERT TO R1 ON Companies
GRANT PRIVILEGE INSERT TO R2 ON Products
GRANT PRIVILEGE INSERT TO R3 ON Customers
GRANT PRIVILEGE SELECT TO R3 ON Companies
GRANT PRIVILEGE SELECT TO R3 ON Products
GRANT PRIVILEGE SELECT TO R3 ON Customers
GRANT PRIVILEGE SELECT TO R2 ON Companies
GRANT PRIVILEGE SELECT TO R2 ON Products
GRANT PRIVILEGE SELECT TO R1 ON Companies
LOGIN U1 PASS70
LOGIN USERR PASS70
LOGIN U1 P1
CREATE ROLE RDUMMY DK
CREATE USER U70 P70
GRANT ROLE U70 RDUMMY
GRANT PRIVILEGE INSERT TO RDUMMY ON Companies
INSERT INTO Companies VALUES ('1', 'name 1', 'location 1', 'IN') ENCRYPT 2 R1
INSERT INTO Companies VALUES ('2', 'name 2', 'location 2', 'CA') ENCRYPT 3 R1
LOGIN U3 P3
SELECT * FROM Companies
INSERT INTO Products VALUES ('1', 'product 1', 'category 1', '1', '19.99') ENCRYPT 2 R2
INSERT INTO Companies VALUES ('3', 'name 3', 'location 3', 'IL') ENCRYPT 0 R1
LOGIN U2 P2
SELECT * FROM Companies
SELECT * FROM Products
INSERT INTO Customers VALUES ('1', 'first 1', 'last 1', 'address 1') ENCRYPT 4 R3
INSERT INTO Companies VALUES ('4', 'name 4', 'location 4', 'WA') ENCRYPT 4 R1
INSERT INTO Products VALUES ('2', 'product 2', 'category 2', '2', '99.99') ENCRYPT 3 R2
INSERT INTO Customers VALUES ('2', 'first 2', 'last 2', 'address 2') ENCRYPT 2 R3
LOGIN U4 P4
SELECT * FROM Customers
SELECT * FROM Companies
SELECT * FROM Products
LOGIN U1 P1
INSERT INTO Products VALUES ('3', 'product 3', 'category 3', '3', '33.33') ENCRYPT 5 R2
INSERT INTO Customers VALUES ('3', 'first 3', 'last 3', 'address 3') ENCRYPT 3 R3
SELECT * FROM Products
SELECT * FROM Customers
LOGIN U3 P3
SELECT * FROM Customers
REVOKE PRIVILEGE SELECT FROM R3 ON Companies
LOGIN admin pass
REVOKE PRIVILEGE SELECT FROM R3 ON Companies
LOGIN U4 P4
SELECT * FROM Companies
QUIT
